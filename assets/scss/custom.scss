//Global vars
$sunburst-color1: darkorange;
$sunburst-color2: orange;
$text-color-primary: black;
$button-color-primary: #622424;
$button-color-primary-active: darken($button-color-primary, 2.5%);
$form-el-color-shadow: rgba(0, 0, 0, .5);
$tilt-left: rotate(-15deg);
$tilt-right: rotate(15deg);

$title-margin-bottom: 1em;


@function do-background($color1, $color2, $deg) {
  $i: 180 - $deg;
  $bg: "";
  $current-color: $color1;

  @while $i >= 0 {
    $bg: $bg + 'linear-gradient(#{$i}deg, transparent 50%, #{$current-color} 50%, #{$current-color} 100%), ';
    $i:$i - $deg;

    $current-color : if($current-color == $color1, $color2, $color1);
  }

  $punultimate-idx: str_length($bg) - 2;

  @return unquote(str_slice($bg, 0, $punultimate-idx));
}

@mixin copy-type {
  font-family: 'Montserrat', sans-serif;
}

@mixin title-type {
  font-family: 'Fugaz One', cursive;
  color: $text-color-primary;
}

@mixin full-screen {
  height: 100%;
  overflow: hidden;
  position: absolute;
  width: 100%;
}

@mixin flex-center {
  align-items: center;
  display: flex;
  justify-content: center;
}

@keyframes spin {
  from {
    transform: translate(-50%, -50%) rotate(0deg);
  }

  to {
    transform: translate(-50%, -50%) rotate(360deg);
  }
}

html {
  @include copy-type;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  width: 100%;
}

.pad-0 {
  padding: 0;
}

h1, h2, h3 {
  @include title-type;
}

.button, .input {
  box-shadow: $form-el-color-shadow 0 2pt 2pt;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.button.is-primary {
  background-color: $button-color-primary;

  &:hover,
  &:active {
    background-color: $button-color-primary-active;
  }
}

.sunburst.outer {
  @include full-screen;

  .inner {
    animation: spin 45s linear infinite paused;
    height: 300%;
    left: 50%;
    position: absolute;
    top: 44%;
    transform: translate(-50%, -50%);
    width: 300%;

    &.animated {
      animation-play-state: running;
    }

    .gradient-wrap {
      height: 50%;
      overflow: hidden;
      width: 100%;

      &:last-child {
        transform: rotate(180deg);
      }
    }

    .gradient {
      background: do-background($sunburst-color1, $sunburst-color2, 10);
      height: 200%;
      width: 100%;
    }
  }
}

.starburst {
  @include flex-center;

  text-align: center;

  ::before,
  ::after {
    background: inherit;
    content: "";
    height: 100%;
    left: 0;
    position: absolute;
    top: 0;
    width: 100%;
    z-index: -1;
  }

  ::before {
    transform: rotate(30deg);
  }

  ::after {
    transform: rotate(-30deg);
  }
}

.section .step {
  @include full-screen;

  @include flex-center;

  @mixin anim-props($anim, $direction, $count: 1, $duration: .25s) {
    animation: $anim $direction $duration;
    animation-iteration-count: $count;
  }

  @keyframes animScaleUp {
    100% {
      transform: scale(1.25);
    }
  }

  @keyframes animShake0 {
    0% {
      transform: rotate(-15deg);
    }
    100% {
      transform: rotate(15deg);
    }
  }

  @keyframes animShake1 {
    0% {
      transform: $tilt-right;
    }
    100% {
      transform: $tilt-left;
    }
  }

  .scale-0 {
    @include anim-props(animScaleUp, alternate, 2)
  }

  h1 {
    bottom: $title-margin-bottom;
    font-size: 13.333vw;
    position: absolute;
    text-align: center;
    text-shadow: white 0 2pt 2pt;
    width: 100%;
  }

  .bottle {
    height: 100vw;
    left: -15vw;
    max-width: none;
    position: absolute;
    top: 12.5vw; //25vw;

    &.rotated-0 {
      transform: $tilt-left;
    }
    &.rotated-1 {
      transform: $tilt-right;
    }

    @mixin shake-props($anim) {
      @include anim-props($anim, alternate, 4, .25s);
    }

    &.shake-0 {
      @include shake-props(animShake0)
    }

    &.shake-1 {
      @include shake-props(animShake1)
      }

    &.tilt-0 {
      @include anim-props(anim-tilt-item-left, forwards ease-in-out, 1, .125s);
    }

    &.tilt-1 {
      @include anim-props(anim-tilt-item-right, forwards ease-in-out, 1, .125s);
    }
  }

  form {
    @include flex-center;

    .formfield {
      bottom: 1em;
      position: absolute;
      width: 90vw;

      .input.is-fullwidth {
        position: relative;
        top: -.5em;
      }
    }
  }

}

#ad-steps {
  position: initial;
}


@keyframes anim-flip-title {
  0% {
    bottom: 0;
    transform: rotateX(90deg);
  }
  100% {
    bottom: $title-margin-bottom;
    transform: rotateX(0deg);
  }
}

@mixin anim-side-by-value($animSide, $amount) {
  100% {
      #{$animSide}: #{$amount};
  }
}

@keyframes anim-tilt-item-left {
  @include anim-side-by-value(transform, $tilt-left);
}

@keyframes anim-tilt-item-right {
  @include anim-side-by-value(transform, $tilt-right);
}

@keyframes anim-exit-title-to-bottom {
  @include anim-side-by-value(bottom, -1.5em);
}

@keyframes anim-exit-bottle-to-top {
  @include anim-side-by-value(top, -95vw);
}

@keyframes anim-exit-form-to-bottom {
  @include anim-side-by-value(bottom, -5em);
}

@mixin hide-h1($time) {
  h1 {
    animation: forwards anim-exit-title-to-bottom ease-in-out $time;
  }
}

#thank-you {
  h1 {
    animation: running anim-flip-title ease-in-out .5s;
  }

  &.pre-anim {
    animation-play-state: paused;
    transform: rotateX(90deg);
  }

  &.hide {
    @include hide-h1(.25s);

    .bottle {
      animation: forwards ease-in-out anim-exit-bottle-to-top .5s;
    }
  }
}

#sign-up {
  h1 {
    bottom: 2.5em;
  }

  &.hide {
    @include hide-h1(.33s);

    /*.bottle {
      animation: forwards ease-in-out anim-exit-bottle-to-top .5s;
    }*/

    #form-sign-up .formfield {
      animation: forwards ease-in-out anim-exit-form-to-bottom .25s;
    }
  }
}

#play-ar {
  h1 {
    bottom: 0.125em;
  }

  .button {
    bottom: 4em;
    position: absolute;
  }

  .bottle{
    &:first-of-type,
    &:nth-of-type(2) {
      transform-origin: 50% 120%;
    }
  }

  &.hide {
    @include hide-h1(.125s);

    .button {
      animation: forwards ease-in-out anim-exit-form-to-bottom .25s;
    }
  }
}

#amazing {
}